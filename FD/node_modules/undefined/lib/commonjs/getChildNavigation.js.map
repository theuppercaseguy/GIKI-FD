{"version":3,"names":["_getChildEventSubscriber","_interopRequireDefault","require","_getChildRouter","_getNavigationActionCreators","_getChildrenNavigationCache","createParamGetter","route","paramName","defaultValue","params","getChildNavigation","navigation","childKey","getCurrentParentNavigation","children","getChildrenNavigationCache","childRoute","state","routes","find","r","key","childRouter","getChildRouter","router","routeName","focusedGrandChildRoute","index","actionCreators","_objectSpread2","default","actions","getActionCreators","getNavigationActionCreators","actionHelpers","Object","keys","forEach","actionName","actionCreator","action","apply","arguments","dispatch","isFirstRouteInParent","parentNavigation","indexOf","getParam","childSubscriber","getChildEventSubscriber","addListener","grandChildKey","nav","isFocused","currentNavigation","_currentNavigation$st","getScreenProps","dangerouslyGetParent","emit","_default","exports"],"sources":["getChildNavigation.js"],"sourcesContent":["import getChildEventSubscriber from './getChildEventSubscriber';\nimport getChildRouter from './getChildRouter';\nimport getNavigationActionCreators from './routers/getNavigationActionCreators';\nimport getChildrenNavigationCache from './getChildrenNavigationCache';\n\nconst createParamGetter = route => (paramName, defaultValue) => {\n  const params = route.params;\n\n  if (params && paramName in params) {\n    return params[paramName];\n  }\n\n  return defaultValue;\n};\n\nfunction getChildNavigation(navigation, childKey, getCurrentParentNavigation) {\n  const children = getChildrenNavigationCache(navigation);\n  const childRoute = navigation.state.routes.find(r => r.key === childKey);\n\n  if (!childRoute) {\n    return null;\n  }\n\n  if (children[childKey] && children[childKey].state === childRoute) {\n    return children[childKey];\n  }\n\n  const childRouter = getChildRouter(navigation.router, childRoute.routeName);\n\n  // If the route has children, we'll use this to pass in to the action creators\n  // for the childRouter so that any action that depends on the active route will\n  // behave as expected. We don't explicitly require that routers implement routes\n  // and index properties, but if we did then we would put an invariant here to\n  // ensure that a focusedGrandChildRoute exists if childRouter is defined.\n  const focusedGrandChildRoute =\n    childRoute.routes && typeof childRoute.index === 'number'\n      ? childRoute.routes[childRoute.index]\n      : null;\n\n  const actionCreators = {\n    ...navigation.actions,\n    ...navigation.router.getActionCreators(childRoute, navigation.state.key),\n    ...(childRouter\n      ? childRouter.getActionCreators(focusedGrandChildRoute, childRoute.key)\n      : {}),\n    ...getNavigationActionCreators(childRoute),\n  };\n\n  const actionHelpers = {};\n  Object.keys(actionCreators).forEach(actionName => {\n    actionHelpers[actionName] = (...args) => {\n      const actionCreator = actionCreators[actionName];\n      const action = actionCreator(...args);\n      return navigation.dispatch(action);\n    };\n  });\n\n  let isFirstRouteInParent = true;\n\n  const parentNavigation = getCurrentParentNavigation();\n\n  if (parentNavigation) {\n    isFirstRouteInParent =\n      parentNavigation.state.routes.indexOf(childRoute) === 0;\n  }\n\n  if (\n    children[childKey] &&\n    children[childKey].isFirstRouteInParent() === isFirstRouteInParent\n  ) {\n    children[childKey] = {\n      ...children[childKey],\n      ...actionHelpers,\n      state: childRoute,\n      router: childRouter,\n      actions: actionCreators,\n      getParam: createParamGetter(childRoute),\n    };\n    return children[childKey];\n  } else {\n    const childSubscriber = getChildEventSubscriber(\n      navigation.addListener,\n      childKey\n    );\n\n    children[childKey] = {\n      ...actionHelpers,\n\n      state: childRoute,\n      router: childRouter,\n      actions: actionCreators,\n      getParam: createParamGetter(childRoute),\n\n      getChildNavigation: grandChildKey =>\n        getChildNavigation(children[childKey], grandChildKey, () => {\n          const nav = getCurrentParentNavigation();\n          return nav && nav.getChildNavigation(childKey);\n        }),\n\n      isFocused: () => {\n        const currentNavigation = getCurrentParentNavigation();\n        if (!currentNavigation) {\n          return false;\n        }\n        const { routes, index } = currentNavigation.state;\n        if (!currentNavigation.isFocused()) {\n          return false;\n        }\n        if (routes[index].key === childKey) {\n          return true;\n        }\n        return false;\n      },\n      isFirstRouteInParent: () => isFirstRouteInParent,\n      dispatch: navigation.dispatch,\n      getScreenProps: navigation.getScreenProps,\n      dangerouslyGetParent: getCurrentParentNavigation,\n      addListener: childSubscriber.addListener,\n      emit: childSubscriber.emit,\n    };\n    return children[childKey];\n  }\n}\n\nexport default getChildNavigation;\n"],"mappings":"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"}