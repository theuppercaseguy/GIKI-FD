{"version":3,"names":["getChildEventSubscriber","getChildRouter","getNavigationActionCreators","getChildrenNavigationCache","createParamGetter","route","paramName","defaultValue","params","getChildNavigation","navigation","childKey","getCurrentParentNavigation","children","childRoute","state","routes","find","r","key","childRouter","router","routeName","focusedGrandChildRoute","index","actionCreators","_objectSpread","actions","getActionCreators","actionHelpers","Object","keys","forEach","actionName","actionCreator","action","apply","arguments","dispatch","isFirstRouteInParent","parentNavigation","indexOf","getParam","childSubscriber","addListener","grandChildKey","nav","isFocused","currentNavigation","_currentNavigation$st","getScreenProps","dangerouslyGetParent","emit"],"sources":["getChildNavigation.js"],"sourcesContent":["import getChildEventSubscriber from './getChildEventSubscriber';\nimport getChildRouter from './getChildRouter';\nimport getNavigationActionCreators from './routers/getNavigationActionCreators';\nimport getChildrenNavigationCache from './getChildrenNavigationCache';\n\nconst createParamGetter = route => (paramName, defaultValue) => {\n  const params = route.params;\n\n  if (params && paramName in params) {\n    return params[paramName];\n  }\n\n  return defaultValue;\n};\n\nfunction getChildNavigation(navigation, childKey, getCurrentParentNavigation) {\n  const children = getChildrenNavigationCache(navigation);\n  const childRoute = navigation.state.routes.find(r => r.key === childKey);\n\n  if (!childRoute) {\n    return null;\n  }\n\n  if (children[childKey] && children[childKey].state === childRoute) {\n    return children[childKey];\n  }\n\n  const childRouter = getChildRouter(navigation.router, childRoute.routeName);\n\n  // If the route has children, we'll use this to pass in to the action creators\n  // for the childRouter so that any action that depends on the active route will\n  // behave as expected. We don't explicitly require that routers implement routes\n  // and index properties, but if we did then we would put an invariant here to\n  // ensure that a focusedGrandChildRoute exists if childRouter is defined.\n  const focusedGrandChildRoute =\n    childRoute.routes && typeof childRoute.index === 'number'\n      ? childRoute.routes[childRoute.index]\n      : null;\n\n  const actionCreators = {\n    ...navigation.actions,\n    ...navigation.router.getActionCreators(childRoute, navigation.state.key),\n    ...(childRouter\n      ? childRouter.getActionCreators(focusedGrandChildRoute, childRoute.key)\n      : {}),\n    ...getNavigationActionCreators(childRoute),\n  };\n\n  const actionHelpers = {};\n  Object.keys(actionCreators).forEach(actionName => {\n    actionHelpers[actionName] = (...args) => {\n      const actionCreator = actionCreators[actionName];\n      const action = actionCreator(...args);\n      return navigation.dispatch(action);\n    };\n  });\n\n  let isFirstRouteInParent = true;\n\n  const parentNavigation = getCurrentParentNavigation();\n\n  if (parentNavigation) {\n    isFirstRouteInParent =\n      parentNavigation.state.routes.indexOf(childRoute) === 0;\n  }\n\n  if (\n    children[childKey] &&\n    children[childKey].isFirstRouteInParent() === isFirstRouteInParent\n  ) {\n    children[childKey] = {\n      ...children[childKey],\n      ...actionHelpers,\n      state: childRoute,\n      router: childRouter,\n      actions: actionCreators,\n      getParam: createParamGetter(childRoute),\n    };\n    return children[childKey];\n  } else {\n    const childSubscriber = getChildEventSubscriber(\n      navigation.addListener,\n      childKey\n    );\n\n    children[childKey] = {\n      ...actionHelpers,\n\n      state: childRoute,\n      router: childRouter,\n      actions: actionCreators,\n      getParam: createParamGetter(childRoute),\n\n      getChildNavigation: grandChildKey =>\n        getChildNavigation(children[childKey], grandChildKey, () => {\n          const nav = getCurrentParentNavigation();\n          return nav && nav.getChildNavigation(childKey);\n        }),\n\n      isFocused: () => {\n        const currentNavigation = getCurrentParentNavigation();\n        if (!currentNavigation) {\n          return false;\n        }\n        const { routes, index } = currentNavigation.state;\n        if (!currentNavigation.isFocused()) {\n          return false;\n        }\n        if (routes[index].key === childKey) {\n          return true;\n        }\n        return false;\n      },\n      isFirstRouteInParent: () => isFirstRouteInParent,\n      dispatch: navigation.dispatch,\n      getScreenProps: navigation.getScreenProps,\n      dangerouslyGetParent: getCurrentParentNavigation,\n      addListener: childSubscriber.addListener,\n      emit: childSubscriber.emit,\n    };\n    return children[childKey];\n  }\n}\n\nexport default getChildNavigation;\n"],"mappings":"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"}